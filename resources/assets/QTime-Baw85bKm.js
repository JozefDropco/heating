import{E as $e,G as ae,H as K,I as ie,J as Le,K as U,z as J,L as pe,M as oe,N as Xe,B as ze,e as je,g as Ne,r as W,f as y,w as ge,n as Qe,O as Ue,h as m,T as We,C as Ge}from"./index-m4Lflbw8.js";import{p as A,Q as Je}from"./QCheckbox-DJMVJ3RH.js";import{g as ye,s as _e}from"./touch-BjYP5sR0.js";import{c as Ze}from"./selection-BDbhJi07.js";import{c as Re,d as et,e as tt,g as ut,f as nt,v as lt}from"./_plugin-vue_export-helper-BsH4dlGH.js";import{u as ke,a as at,b as it,g as ot}from"./moment-CjhTHW-K.js";import{_ as G,f as st}from"./date-CDRwwtFc.js";function se(n,d,f){const k=J(n);let t,l=k.left-d.event.x,s=k.top-d.event.y,p=Math.abs(l),g=Math.abs(s);const v=d.direction;v.horizontal===!0&&v.vertical!==!0?t=l<0?"left":"right":v.horizontal!==!0&&v.vertical===!0?t=s<0?"up":"down":v.up===!0&&s<0?(t="up",p>g&&(v.left===!0&&l<0?t="left":v.right===!0&&l>0&&(t="right"))):v.down===!0&&s>0?(t="down",p>g&&(v.left===!0&&l<0?t="left":v.right===!0&&l>0&&(t="right"))):v.left===!0&&l<0?(t="left",p<g&&(v.up===!0&&s<0?t="up":v.down===!0&&s>0&&(t="down"))):v.right===!0&&l>0&&(t="right",p<g&&(v.up===!0&&s<0?t="up":v.down===!0&&s>0&&(t="down")));let O=!1;if(t===void 0&&f===!1){if(d.event.isFirst===!0||d.event.lastDir===void 0)return{};t=d.event.lastDir,O=!0,t==="left"||t==="right"?(k.left-=l,p=0,l=0):(k.top-=s,g=0,s=0)}return{synthetic:O,payload:{evt:n,touch:d.event.mouse!==!0,mouse:d.event.mouse===!0,position:k,direction:t,isFirst:d.event.isFirst,isFinal:f===!0,duration:Date.now()-d.event.time,distance:{x:p,y:g},offset:{x:l,y:s},delta:{x:k.left-d.event.lastX,y:k.top-d.event.lastY}}}}let rt=0;const ct=$e({name:"touch-pan",beforeMount(n,{value:d,modifiers:f}){if(f.mouse!==!0&&K.has.touch!==!0)return;function k(l,s){f.mouse===!0&&s===!0?ze(l):(f.stop===!0&&oe(l),f.prevent===!0&&pe(l))}const t={uid:"qvtp_"+rt++,handler:d,modifiers:f,direction:ye(f),noop:Le,mouseStart(l){_e(l,t)&&Xe(l)&&(U(t,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),t.start(l,!0))},touchStart(l){if(_e(l,t)){const s=l.target;U(t,"temp",[[s,"touchmove","move","notPassiveCapture"],[s,"touchcancel","end","passiveCapture"],[s,"touchend","end","passiveCapture"]]),t.start(l)}},start(l,s){if(K.is.firefox===!0&&ie(n,!0),t.lastEvt=l,s===!0||f.stop===!0){if(t.direction.all!==!0&&(s!==!0||t.modifiers.mouseAllDir!==!0&&t.modifiers.mousealldir!==!0)){const v=l.type.indexOf("mouse")!==-1?new MouseEvent(l.type,l):new TouchEvent(l.type,l);l.defaultPrevented===!0&&pe(v),l.cancelBubble===!0&&oe(v),Object.assign(v,{qKeyEvent:l.qKeyEvent,qClickOutside:l.qClickOutside,qAnchorHandled:l.qAnchorHandled,qClonedBy:l.qClonedBy===void 0?[t.uid]:l.qClonedBy.concat(t.uid)}),t.initialEvent={target:l.target,event:v}}oe(l)}const{left:p,top:g}=J(l);t.event={x:p,y:g,time:Date.now(),mouse:s===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:p,lastY:g}},move(l){if(t.event===void 0)return;const s=J(l),p=s.left-t.event.x,g=s.top-t.event.y;if(p===0&&g===0)return;t.lastEvt=l;const v=t.event.mouse===!0,O=()=>{k(l,v);let C;f.preserveCursor!==!0&&f.preservecursor!==!0&&(C=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),v===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Ze(),t.styleCleanup=S=>{if(t.styleCleanup=void 0,C!==void 0&&(document.documentElement.style.cursor=C),document.body.classList.remove("non-selectable"),v===!0){const E=()=>{document.body.classList.remove("no-pointer-events--children")};S!==void 0?setTimeout(()=>{E(),S()},50):E()}else S!==void 0&&S()}};if(t.event.detected===!0){t.event.isFirst!==!0&&k(l,t.event.mouse);const{payload:C,synthetic:S}=se(l,t,!1);C!==void 0&&(t.handler(C)===!1?t.end(l):(t.styleCleanup===void 0&&t.event.isFirst===!0&&O(),t.event.lastX=C.position.left,t.event.lastY=C.position.top,t.event.lastDir=S===!0?void 0:C.direction,t.event.isFirst=!1));return}if(t.direction.all===!0||v===!0&&(t.modifiers.mouseAllDir===!0||t.modifiers.mousealldir===!0)){O(),t.event.detected=!0,t.move(l);return}const D=Math.abs(p),b=Math.abs(g);D!==b&&(t.direction.horizontal===!0&&D>b||t.direction.vertical===!0&&D<b||t.direction.up===!0&&D<b&&g<0||t.direction.down===!0&&D<b&&g>0||t.direction.left===!0&&D>b&&p<0||t.direction.right===!0&&D>b&&p>0?(t.event.detected=!0,t.move(l)):t.end(l,!0))},end(l,s){if(t.event!==void 0){if(ae(t,"temp"),K.is.firefox===!0&&ie(n,!1),s===!0)t.styleCleanup?.(),t.event.detected!==!0&&t.initialEvent!==void 0&&t.initialEvent.target.dispatchEvent(t.initialEvent.event);else if(t.event.detected===!0){t.event.isFirst===!0&&t.handler(se(l===void 0?t.lastEvt:l,t).payload);const{payload:p}=se(l===void 0?t.lastEvt:l,t,!0),g=()=>{t.handler(p)};t.styleCleanup!==void 0?t.styleCleanup(g):g()}t.event=void 0,t.initialEvent=void 0,t.lastEvt=void 0}}};if(n.__qtouchpan=t,f.mouse===!0){const l=f.mouseCapture===!0||f.mousecapture===!0?"Capture":"";U(t,"main",[[n,"mousedown","mouseStart",`passive${l}`]])}K.has.touch===!0&&U(t,"main",[[n,"touchstart","touchStart",`passive${f.capture===!0?"Capture":""}`],[n,"touchmove","noop","notPassiveCapture"]])},updated(n,d){const f=n.__qtouchpan;f!==void 0&&(d.oldValue!==d.value&&(typeof value!="function"&&f.end(),f.handler=d.value),f.direction=ye(d.modifiers))},beforeUnmount(n){const d=n.__qtouchpan;d!==void 0&&(d.event!==void 0&&d.end(),ae(d,"main"),ae(d,"temp"),K.is.firefox===!0&&ie(n,!1),d.styleCleanup?.(),delete n.__qtouchpan)}});function dt(n,d){return n.hour!==null&&n.minute===null?"minute":"hour"}function vt(){const n=new Date;return{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds(),millisecond:n.getMilliseconds()}}const kt=je({name:"QTime",props:{...et,...Re,...ke,modelValue:{required:!0,validator:n=>typeof n=="string"||n===null},mask:{...ke.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:n=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(n)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:at,setup(n,{slots:d,emit:f}){const k=Ne(),{$q:t}=k.proxy,l=tt(n,t),{tabindex:s,headerClass:p,getLocale:g,getCurrentDate:v}=it(n,t),O=ut(n),D=nt(O);let b,C;const S=W(null),E=y(()=>xe()),T=y(()=>g()),re=y(()=>De()),I=G(n.modelValue,E.value,T.value,n.calendar,re.value),c=W(dt(I)),a=W(I),_=W(I.hour===null||I.hour<12),Ce=y(()=>`q-time q-time--${n.landscape===!0?"landscape":"portrait"}`+(l.value===!0?" q-time--dark q-dark":"")+(n.disable===!0?" disabled":n.readonly===!0?" q-time--readonly":"")+(n.bordered===!0?" q-time--bordered":"")+(n.square===!0?" q-time--square no-border-radius":"")+(n.flat===!0?" q-time--flat no-shadow":"")),Z=y(()=>{const e=a.value;return{hour:e.hour===null?"--":w.value===!0?A(e.hour):String(_.value===!0?e.hour===0?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:e.minute===null?"--":A(e.minute),second:e.second===null?"--":A(e.second)}}),w=y(()=>n.format24h!==null?n.format24h:t.lang.date.format24h),qe=y(()=>{const e=c.value==="hour",u=e===!0?12:60,i=a.value[c.value];let h=`rotate(${Math.round(i*(360/u))-180}deg) translateX(-50%)`;return e===!0&&w.value===!0&&a.value.hour>=12&&(h+=" scale(.7)"),{transform:h}}),ce=y(()=>a.value.hour!==null),be=y(()=>ce.value===!0&&a.value.minute!==null),V=y(()=>n.hourOptions!==void 0?e=>n.hourOptions.includes(e):n.options!==void 0?e=>n.options(e,null,null):null),Y=y(()=>n.minuteOptions!==void 0?e=>n.minuteOptions.includes(e):n.options!==void 0?e=>n.options(a.value.hour,e,null):null),$=y(()=>n.secondOptions!==void 0?e=>n.secondOptions.includes(e):n.options!==void 0?e=>n.options(a.value.hour,a.value.minute,e):null),x=y(()=>{if(V.value===null)return null;const e=X(0,11,V.value),u=X(12,11,V.value);return{am:e,pm:u,values:e.values.concat(u.values)}}),F=y(()=>Y.value!==null?X(0,59,Y.value):null),P=y(()=>$.value!==null?X(0,59,$.value):null),L=y(()=>{switch(c.value){case"hour":return x.value;case"minute":return F.value;case"second":return P.value}}),we=y(()=>{let e,u,i=0,r=1;const h=L.value!==null?L.value.values:void 0;c.value==="hour"?w.value===!0?(e=0,u=23):(e=0,u=11,_.value===!1&&(i=12)):(e=0,u=55,r=5);const M=[];for(let o=e,q=e;o<=u;o+=r,q++){const H=o+i,Ie=h?.includes(H)===!1,Ye=c.value==="hour"&&o===0?w.value===!0?"00":"12":o;M.push({val:H,index:q,disable:Ie,label:Ye})}return M}),Me=y(()=>[[ct,Se,void 0,{stop:!0,prevent:!0,mouse:!0}]]);ge(()=>n.modelValue,e=>{const u=G(e,E.value,T.value,n.calendar,re.value);(u.dateHash!==a.value.dateHash||u.timeHash!==a.value.timeHash)&&(a.value=u,u.hour===null?c.value="hour":_.value=u.hour<12)}),ge([E,T],()=>{Qe(()=>{le()})});function de(){const e={...v(),...vt()};le(e),Object.assign(a.value,e),c.value="hour"}function X(e,u,i){const r=Array.apply(null,{length:u+1}).map((h,M)=>{const o=M+e;return{index:o,val:i(o)===!0}}).filter(h=>h.val===!0).map(h=>h.index);return{min:r[0],max:r[r.length-1],values:r,threshold:u+1}}function ve(e,u,i){const r=Math.abs(e-u);return Math.min(r,i-r)}function R(e,{min:u,max:i,values:r,threshold:h}){if(e===u)return u;if(e<u||e>i)return ve(e,u,h)<=ve(e,i,h)?u:i;const M=r.findIndex(H=>e<=H),o=r[M-1],q=r[M];return e-o<=q-e?o:q}function xe(){return n.calendar!=="persian"&&n.mask!==null?n.mask:`HH:mm${n.withSeconds===!0?":ss":""}`}function De(){if(typeof n.defaultDate!="string"){const e=v(!0);return e.dateHash=ot(e),e}return G(n.defaultDate,"YYYY/MM/DD",void 0,n.calendar)}function ee(){return lt(k)===!0||L.value!==null&&(L.value.values.length===0||c.value==="hour"&&w.value!==!0&&x.value[_.value===!0?"am":"pm"].values.length===0)}function te(){const e=S.value,{top:u,left:i,width:r}=e.getBoundingClientRect(),h=r/2;return{top:u+h,left:i+h,dist:h*.7}}function Se(e){if(ee()!==!0){if(e.isFirst===!0){b=te(),C=z(e.evt,b);return}C=z(e.evt,b,C),e.isFinal===!0&&(b=!1,C=null,fe())}}function fe(){c.value==="hour"?c.value="minute":n.withSeconds&&c.value==="minute"&&(c.value="second")}function z(e,u,i){const r=J(e),h=Math.abs(r.top-u.top),M=Math.sqrt(Math.pow(Math.abs(r.top-u.top),2)+Math.pow(Math.abs(r.left-u.left),2));let o,q=Math.asin(h/M)*(180/Math.PI);if(r.top<u.top?q=u.left<r.left?90-q:270+q:q=u.left<r.left?q+90:270-q,c.value==="hour"){if(o=q/30,x.value!==null){const H=w.value!==!0?_.value===!0:x.value.am.values.length!==0&&x.value.pm.values.length!==0?M>=u.dist:x.value.am.values.length!==0;o=R(o+(H===!0?0:12),x.value[H===!0?"am":"pm"])}else o=Math.round(o),w.value===!0?M<u.dist?o<12&&(o+=12):o===12&&(o=0):_.value===!0&&o===12?o=0:_.value===!1&&o!==12&&(o+=12);w.value===!0&&(_.value=o<12)}else o=Math.round(q/6)%60,c.value==="minute"&&F.value!==null?o=R(o,F.value):c.value==="second"&&P.value!==null&&(o=R(o,P.value));return i!==o&&Be[c.value](o),o}const ue={hour(){c.value="hour"},minute(){c.value="minute"},second(){c.value="second"}};function Oe(e){e.keyCode===13&&me()}function Ee(e){e.keyCode===13&&he()}function He(e){ee()!==!0&&(t.platform.is.desktop!==!0&&z(e,te()),fe())}function Ae(e){ee()!==!0&&z(e,te())}function Ve(e){if(e.keyCode===13)c.value="hour";else if([37,39].includes(e.keyCode)){const u=e.keyCode===37?-1:1;if(x.value!==null){const i=w.value===!0?x.value.values:x.value[_.value===!0?"am":"pm"].values;if(i.length===0)return;if(a.value.hour===null)j(i[0]);else{const r=(i.length+i.indexOf(a.value.hour)+u)%i.length;j(i[r])}}else{const i=w.value===!0?24:12,r=w.value!==!0&&_.value===!1?12:0,h=a.value.hour===null?-u:a.value.hour;j(r+(24+h+u)%i)}}}function Fe(e){if(e.keyCode===13)c.value="minute";else if([37,39].includes(e.keyCode)){const u=e.keyCode===37?-1:1;if(F.value!==null){const i=F.value.values;if(i.length===0)return;if(a.value.minute===null)N(i[0]);else{const r=(i.length+i.indexOf(a.value.minute)+u)%i.length;N(i[r])}}else{const i=a.value.minute===null?-u:a.value.minute;N((60+i+u)%60)}}}function Pe(e){if(e.keyCode===13)c.value="second";else if([37,39].includes(e.keyCode)){const u=e.keyCode===37?-1:1;if(P.value!==null){const i=P.value.values;if(i.length===0)return;if(a.value.seconds===null)Q(i[0]);else{const r=(i.length+i.indexOf(a.value.second)+u)%i.length;Q(i[r])}}else{const i=a.value.second===null?-u:a.value.second;Q((60+i+u)%60)}}}function j(e){a.value.hour!==e&&(a.value.hour=e,B())}function N(e){a.value.minute!==e&&(a.value.minute=e,B())}function Q(e){a.value.second!==e&&(a.value.second=e,B())}const Be={hour:j,minute:N,second:Q};function me(){_.value===!1&&(_.value=!0,a.value.hour!==null&&(a.value.hour-=12,B()))}function he(){_.value===!0&&(_.value=!1,a.value.hour!==null&&(a.value.hour+=12,B()))}function ne(e){const u=n.modelValue;c.value!==e&&u!==void 0&&u!==null&&u!==""&&typeof u!="string"&&(c.value=e)}function B(){if(V.value!==null&&V.value(a.value.hour)!==!0){a.value=G(),ne("hour");return}if(Y.value!==null&&Y.value(a.value.minute)!==!0){a.value.minute=null,a.value.second=null,ne("minute");return}if(n.withSeconds===!0&&$.value!==null&&$.value(a.value.second)!==!0){a.value.second=null,ne("second");return}a.value.hour===null||a.value.minute===null||n.withSeconds===!0&&a.value.second===null||le()}function le(e){const u=Object.assign({...a.value},e),i=n.calendar==="persian"?A(u.hour)+":"+A(u.minute)+(n.withSeconds===!0?":"+A(u.second):""):st(new Date(u.year,u.month===null?null:u.month-1,u.day,u.hour,u.minute,u.second,u.millisecond),E.value,T.value,u.year,u.timezoneOffset);u.changed=i!==n.modelValue,f("update:modelValue",i,u)}function Ke(){const e=[m("div",{class:"q-time__link "+(c.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:s.value,onClick:ue.hour,onKeyup:Ve},Z.value.hour),m("div",":"),m("div",ce.value===!0?{class:"q-time__link "+(c.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:s.value,onKeyup:Fe,onClick:ue.minute}:{class:"q-time__link"},Z.value.minute)];n.withSeconds===!0&&e.push(m("div",":"),m("div",be.value===!0?{class:"q-time__link "+(c.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:s.value,onKeyup:Pe,onClick:ue.second}:{class:"q-time__link"},Z.value.second));const u=[m("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},e)];return w.value===!1&&u.push(m("div",{class:"q-time__header-ampm column items-between no-wrap"},[m("div",{class:"q-time__link "+(_.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:s.value,onClick:me,onKeyup:Oe},"AM"),m("div",{class:"q-time__link "+(_.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:s.value,onClick:he,onKeyup:Ee},"PM")])),m("div",{class:"q-time__header flex flex-center no-wrap "+p.value},u)}function Te(){const e=a.value[c.value];return m("div",{class:"q-time__content col relative-position"},[m(We,{name:"q-transition--scale"},()=>m("div",{key:"clock"+c.value,class:"q-time__container-parent absolute-full"},[m("div",{ref:S,class:"q-time__container-child fit overflow-hidden"},[Ge(m("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:He,onMousedown:Ae},[m("div",{class:"q-time__clock-circle fit"},[m("div",{class:"q-time__clock-pointer"+(a.value[c.value]===null?" hidden":n.color!==void 0?` text-${n.color}`:""),style:qe.value}),we.value.map(u=>m("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${u.index}`+(u.val===e?" q-time__clock-position--active "+p.value:u.disable===!0?" q-time__clock-position--disable":"")},[m("span",u.label)]))])]),Me.value)])])),n.nowBtn===!0?m(Je,{class:"q-time__now-button absolute",icon:t.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:n.color,textColor:n.textColor,tabindex:s.value,onClick:de}):null])}return k.proxy.setNow=de,()=>{const e=[Te()],u=Ue(d.default);return u!==void 0&&e.push(m("div",{class:"q-time__actions"},u)),n.name!==void 0&&n.disable!==!0&&D(e,"push"),m("div",{class:Ce.value,tabindex:-1},[Ke(),m("div",{class:"q-time__main col overflow-auto"},e)])}}});export{kt as Q,ct as T};
